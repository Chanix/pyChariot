import{_ as n,C as h,c as p,o as k,j as i,a0 as l,a as s,G as e}from"./chunks/framework.6RT3NpRm.js";const R=JSON.parse('{"title":"pyChariot.api.memdb","description":"","frontmatter":{"layout":"doc"},"headers":[],"relativePath":"jsapi_memdb.md","filePath":"jsapi_memdb.md","lastUpdated":1749442209000}'),d={name:"jsapi_memdb.md"},E={id:"pychariot-api-memdb",tabindex:"-1"},r={id:"execute",tabindex:"-1"},y={id:"fetchOne",tabindex:"-1"},g={id:"fetchAll",tabindex:"-1"},o={id:"fetchMany",tabindex:"-1"},A={id:"getRowCount",tabindex:"-1"},b={id:"getLastRowId",tabindex:"-1"},x={id:"renew",tabindex:"-1"},F={id:"load(filepath)",tabindex:"-1"},f={id:"dump(filepath)",tabindex:"-1"};function m(_,t,C,u,S,T){const a=h("Badge");return k(),p("div",null,[i("h1",E,[t[0]||(t[0]=s("pyChariot.api.memdb ")),e(a,{type:"tip",text:"Since 25.3.5.1"}),t[1]||(t[1]=s()),t[2]||(t[2]=i("a",{class:"header-anchor",href:"#pychariot-api-memdb","aria-label":'Permalink to "pyChariot.api.memdb <Badge type="tip" text="Since 25.3.5.1" />"'},"​",-1))]),t[30]||(t[30]=i("p",null,"开箱即用的简单内存数据库，处理简单的数据处理和应用逻辑。",-1)),t[31]||(t[31]=i("p",null,"基于 sqlite3 的 :memory: 实现，数据存储在内存中，并非真正技术意义上的内存数据库。 所有操作都使用同一个数据库连接，不支持事务，需自行处理数据完整和安全性。",-1)),t[32]||(t[32]=i("p",null,"更复杂更高级的数据库处理请使用 pyChariot.sqlite3 。",-1)),i("h2",r,[t[3]||(t[3]=s("execute(sql, if_fetch) ")),e(a,{type:"tip",text:"Since 25.3.5.1"}),t[4]||(t[4]=s()),t[5]||(t[5]=i("a",{class:"header-anchor",href:"#execute","aria-label":'Permalink to "execute(sql, if_fetch) <Badge type="tip" text="Since 25.3.5.1" /> {#execute}"'},"​",-1))]),t[33]||(t[33]=l('<p>执行 SQL 语句</p><table tabindex="0"><thead><tr><th style="text-align:center;">参数</th><th style="text-align:left;">类型</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:center;">sql</td><td style="text-align:left;">string</td><td style="text-align:left;">SQL 语句</td></tr><tr><td style="text-align:center;">if_fetch</td><td style="text-align:left;">bool</td><td style="text-align:left;">是否返回数据，默认为 True</td></tr></tbody></table><table tabindex="0"><thead><tr><th style="text-align:left;">返回值</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">object</td><td style="text-align:left;">如果 if_fetch 为 true，返回游标的数据对象。</td></tr><tr><td style="text-align:left;">null</td><td style="text-align:left;">如果 if_fetch 为 false，返回 null，<br>需通过后继的 fetch 操作获取数据。</td></tr></tbody></table>',3)),i("h2",y,[t[6]||(t[6]=s("fetchOne() ")),e(a,{type:"tip",text:"Since 25.3.5.1"}),t[7]||(t[7]=s()),t[8]||(t[8]=i("a",{class:"header-anchor",href:"#fetchOne","aria-label":'Permalink to "fetchOne() <Badge type="tip" text="Since 25.3.5.1" /> {#fetchOne}"'},"​",-1))]),t[34]||(t[34]=l('<p>获取游标数据（一条）</p><table tabindex="0"><thead><tr><th style="text-align:left;">返回值</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">object</td><td style="text-align:left;">游标数据</td></tr></tbody></table>',2)),i("h2",g,[t[9]||(t[9]=s("fetchAll() ")),e(a,{type:"tip",text:"Since 25.3.5.1"}),t[10]||(t[10]=s()),t[11]||(t[11]=i("a",{class:"header-anchor",href:"#fetchAll","aria-label":'Permalink to "fetchAll() <Badge type="tip" text="Since 25.3.5.1" /> {#fetchAll}"'},"​",-1))]),t[35]||(t[35]=l('<p>获取游标所有数据</p><table tabindex="0"><thead><tr><th style="text-align:left;">返回值</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">object</td><td style="text-align:left;">游标数据</td></tr></tbody></table>',2)),i("h2",o,[t[12]||(t[12]=s("fetchMany(count) ")),e(a,{type:"tip",text:"Since 25.3.5.1"}),t[13]||(t[13]=s()),t[14]||(t[14]=i("a",{class:"header-anchor",href:"#fetchMany","aria-label":'Permalink to "fetchMany(count) <Badge type="tip" text="Since 25.3.5.1" /> {#fetchMany}"'},"​",-1))]),t[36]||(t[36]=l('<p>获取游标数据（指定记录条数）</p><table tabindex="0"><thead><tr><th style="text-align:center;">参数</th><th style="text-align:left;">类型</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:center;">count</td><td style="text-align:left;">number</td><td style="text-align:left;">要获取的记录条数</td></tr></tbody></table><table tabindex="0"><thead><tr><th style="text-align:left;">返回值</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">object</td><td style="text-align:left;">游标数据</td></tr></tbody></table>',3)),i("h2",A,[t[15]||(t[15]=s("getRowCount() ")),e(a,{type:"tip",text:"Since 25.3.5.1"}),t[16]||(t[16]=s()),t[17]||(t[17]=i("a",{class:"header-anchor",href:"#getRowCount","aria-label":'Permalink to "getRowCount() <Badge type="tip" text="Since 25.3.5.1" /> {#getRowCount}"'},"​",-1))]),t[37]||(t[37]=l('<p>获取受影响的记录数</p><table tabindex="0"><thead><tr><th style="text-align:left;">返回值</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">number</td><td style="text-align:left;">受影响的数据库记录数</td></tr></tbody></table>',2)),i("h2",b,[t[18]||(t[18]=s("getLastRowId() ")),e(a,{type:"tip",text:"Since 25.3.5.1"}),t[19]||(t[19]=s()),t[20]||(t[20]=i("a",{class:"header-anchor",href:"#getLastRowId","aria-label":'Permalink to "getLastRowId() <Badge type="tip" text="Since 25.3.5.1" /> {#getLastRowId}"'},"​",-1))]),t[38]||(t[38]=l('<p>获取受上次操作影响的数据库记录 rowid</p><table tabindex="0"><thead><tr><th style="text-align:left;">返回值</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">number</td><td style="text-align:left;">数据库记录 rowid</td></tr></tbody></table>',2)),i("h2",x,[t[21]||(t[21]=s("renew() ")),e(a,{type:"tip",text:"Since 25.3.5.1"}),t[22]||(t[22]=s()),t[23]||(t[23]=i("a",{class:"header-anchor",href:"#renew","aria-label":'Permalink to "renew() <Badge type="tip" text="Since 25.3.5.1" /> {#renew}"'},"​",-1))]),t[39]||(t[39]=i("p",null,"关闭当前内存数据库，重新获得一个新的。",-1)),i("h2",F,[t[24]||(t[24]=s("load(filepath) ")),e(a,{type:"tip",text:"Since 25.6.15.1"}),t[25]||(t[25]=s()),t[26]||(t[26]=i("a",{class:"header-anchor",href:"#load(filepath)","aria-label":'Permalink to "load(filepath) <Badge type="tip" text="Since 25.6.15.1" /> {#load(filepath)}"'},"​",-1))]),t[40]||(t[40]=l('<p>清空当前数据库，并装载指定数据文件。</p><table tabindex="0"><thead><tr><th style="text-align:left;">返回值</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">filepath</td><td style="text-align:left;">数据文件路径，默认为小应用数据目录下的 _memdb.sql</td></tr></tbody></table>',2)),i("h2",f,[t[27]||(t[27]=s("dump(filepath) ")),e(a,{type:"tip",text:"Since 25.6.15.1"}),t[28]||(t[28]=s()),t[29]||(t[29]=i("a",{class:"header-anchor",href:"#dump(filepath)","aria-label":'Permalink to "dump(filepath) <Badge type="tip" text="Since 25.6.15.1" /> {#dump(filepath)}"'},"​",-1))]),t[41]||(t[41]=l(`<p>将当前数据库导出并保存为指定文件，保存的文件可供 load 使用。</p><table tabindex="0"><thead><tr><th style="text-align:left;">返回值</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">filepath</td><td style="text-align:left;">数据文件路径，默认为小应用数据目录下的 _memdb.sql</td></tr></tbody></table><h2 id="一个综合的例子" tabindex="-1">一个综合的例子 <a class="header-anchor" href="#一个综合的例子" aria-label="Permalink to &quot;一个综合的例子&quot;">​</a></h2><p>在这个例子中，首先创建了表 COMPANY，接着向其插入了记录，然后进行查询、更新、删除等操作。并在最后删除了这张表。</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __A.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;CREATE TABLE COMPANY (ID INT PRIMARY KEY NOT NULL, NAME TEXT NOT NULL, AGE INT NOT NULL, ADDRESS CHAR(50), SALARY REAL)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __A.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;SELECT * FROM sqlite_master WHERE type=&#39;table&#39; ORDER BY name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __A.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;PRAGMA table_info(COMPANY)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __A.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;CREATE INDEX idx_company_name ON COMPANY(NAME)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __A.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;INSERT INTO COMPANY (ID,NAME,AGE,ADDRESS,SALARY) VALUES (1, &#39;Paul&#39;, 32, &#39;California&#39;, 20000.00)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __A.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;INSERT INTO COMPANY (ID,NAME,AGE,ADDRESS,SALARY) VALUES (2, &#39;Allen&#39;, 25, &#39;Texas&#39;, 15000.00)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __A.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;INSERT INTO COMPANY (ID,NAME,AGE,ADDRESS,SALARY) VALUES (3, &#39;Teddy&#39;, 23, &#39;Norway&#39;, 20000.00)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __A.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;INSERT INTO COMPANY (ID,NAME,AGE,ADDRESS,SALARY) VALUES (4, &#39;Mark&#39;, 25, &#39;Rich-Mond &#39;, 65000.00)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __A.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;INSERT INTO COMPANY (ID,NAME,AGE,ADDRESS,SALARY) VALUES (5, &#39;David&#39;, 27, &#39;Texas&#39;, 85000.00)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __A.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;INSERT INTO COMPANY (ID,NAME,AGE,ADDRESS,SALARY) VALUES (6, &#39;Kim&#39;, 22, &#39;South-Hall&#39;, 45000.00)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __A.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getLastRowId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __A.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;SELECT * FROM COMPANY&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __A.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getRowCount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __A.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fetchOne</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __A.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fetchMany</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __A.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fetchAll</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __A.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;UPDATE COMPANY SET NAME=&#39;Peter&#39; WHERE ID=1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __A.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getRowCount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __A.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getLastRowId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __A.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;DELETE FROM COMPANY WHERE ID&gt;4&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __A.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getRowCount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __A.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getLastRowId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __A.memdb.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;DROP TABLE COMPANY&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div>`,5))])}const N=n(d,[["render",m]]);export{R as __pageData,N as default};
